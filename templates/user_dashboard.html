<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- This viewport meta tag is crucial for responsiveness -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard - Smart FIR System</title>
    <!-- Make sure the path to your CSS file is correct -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/user_dashboard.css') }}">
</head>
<body>
    <div class="dashboard-container">
        <h1>üöî Smart FIR Filing System</h1>
        <div class="main-container">
            <div class="left-content">
                <section class="fir-section">
                    <h2>üìù File a New FIR</h2>
                    <form id="fir-form" enctype="multipart/form-data">
                        <div class="form-group">
                            <label for="user-name">Your Name:</label>
                            <input type="text" id="user-name" name="user-name" placeholder="Enter your full legal name" required>
                        </div>
                        <div class="form-group">
                            <label for="state">State:</label>
                            <select id="state" name="state" required>
                                <option value="">Select State</option>
                                <option value="Haryana">Haryana</option>
                                <option value="Punjab">Punjab</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="district">District:</label>
                            <select id="district" name="district" required>
                                <option value="">Please select a state first</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="user-address">Your Address:</label>
                            <input type="text" id="user-address" name="user-address" placeholder="Enter your current residential address" required>
                        </div>
                        <div class="form-group">
                            <label for="mobile">Mobile Number:</label>
                            <input type="tel" id="mobile" name="mobile" pattern="[6789][0-9]{9}" title="Enter a valid 10-digit number" required>
                        </div>
                        <div class="form-group">
                            <label for="category">FIR Category:</label>
                            <select id="category" name="category" required>
                                <option value="">Select Category</option>
                                <option value="Theft">Theft</option>
                                <option value="Assault">Assault</option>
                                <option value="Cybercrime">Cyber Crime</option>
                                <option value="Missing">Missing Person</option>
                                <option value="Fraud">Fraud</option>
                                <option value="Harassment">Harassment</option>
                                <option value="Other">Other (Specify)</option>
                            </select>
                        </div>
                        <div class="form-group" id="other-category-field" style="display: none;">
                            <label for="other-category-input">Specify Other Category:</label>
                            <input type="text" id="other-category-input" name="other-category-input" placeholder="Please specify the category">
                        </div>

                        <div class="form-group">
                            <label for="num-accused">Number of Accused:</label>
                            <select id="num-accused" name="num-accused">
                                <option value="Unknown">Unknown</option>
                                <option value="1" selected>1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5+</option>
                            </select>
                        </div>
                        <div id="accused-names-container">
                            <!-- Accused name fields will be generated here by JS -->
                        </div>
                        <div class="form-group">
                            <label for="incident-date">Incident Date & Time:</label>
                            <input type="datetime-local" id="incident-date" name="incident-date" required>
                        </div>
                        <div class="form-group">
                            <label for="location">Incident Location:</label>
                            <input type="text" id="location" name="location" placeholder="e.g., Near Clock Tower, Bhiwani" required>
                        </div>
                        <div class="form-group">
                            <label for="police-station">Nearest Police Station:</label>
                            <select id="police-station" name="police-station" required>
                                <option value="">Select a district first</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="description">Description of Incident:</label>
                            <textarea id="description" name="description" rows="4" placeholder="Describe what happened in detail..." required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="file-upload">Upload Evidence (PDF, JPG, PNG, MP3, MP4):</label>
                            <input type="file" id="file-upload" name="file-upload" multiple accept=".pdf,.jpg,.jpeg,.png,.mp3,.wav,.mp4,.mov">
                        </div>
                        <div class="form-actions">
                            <button type="submit">üöÄ Submit FIR</button>
                            <button type="reset" class="cancel">‚ùå Reset</button>
                        </div>
                    </form>
                </section>

                <section class="view-firs">
                    <h2>üìÇ Your Filed FIRs</h2>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>FIR ID</th>
                                    <th>Status</th>
                                    <th>Investigating Officer</th>
                                    <th>Filed Date</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="fir-list">
                                <tr><td colspan="5">Loading your FIRs...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <section class="emergency-section">
                    <h2>üö® Emergency Contacts</h2>
                    <p><strong>Nearest Police Station:</strong> <span id="display-police-station">Not Selected</span></p>
                    <p><strong>In case of emergency, call:</strong> <span id="emergency-contact">112</span></p>
                </section>

                <button id="logout-btn">Logout</button>
            </div>

            <aside class="chatbot-section">
                <div class="chat-header">
                    <h2>ü§ñ FIR-Bot Assistant</h2>
                    <button id="clear-history-btn" title="Clear chat history">üóëÔ∏è Clear</button>
                </div>
                <div class="chat-container">
                    <div id="chatbox">
                        <!-- Chat messages will appear here -->
                    </div>
                    <div class="suggested-prompts" id="suggested-prompts">
                        <button class="prompt-btn">What is an FIR?</button>
                        <button class="prompt-btn">What are my rights?</button>
                        <button class="prompt-btn">What happens after I file?</button>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="user-message" placeholder="Ask for help or click a suggestion...">
                        <button id="send-message" title="Send message">‚û°Ô∏è</button>
                    </div>
                </div>
            </aside>
            
        </div>
    </div>

    <!-- Modal for displaying FIR details -->
    <div id="fir-details-modal" class="modal-overlay">
        <div id="fir-details-content">
            <span class="close-modal">&times;</span>
            <h2>FIR Details</h2>
            <div id="fir-details">
                <!-- FIR details will be populated here by JS -->
            </div>
        </div>
    </div>

    <!-- Make sure the path to your JS file is correct -->
    <script src="user_dashboard.js" defer></script>
</body>
</html>
